!function(e){var n,t,i=i||function(e){function n(){}var t={},i=t.lib={},r=i.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=r.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=null!=n?n:4*e.length},toString:function(e){return(e||o).stringify(this)},concat:function(e){var n=this.words,t=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var r=0;r<e;r++)n[i+r>>>2]|=(t[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<t.length)for(r=0;r<e;r+=4)n[i+r>>>2]=t[r>>>2];else n.push.apply(n,t);return this.sigBytes+=e,this},clamp:function(){var n=this.words,t=this.sigBytes;n[t>>>2]&=4294967295<<32-t%4*8,n.length=e.ceil(t/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var t=[],i=0;i<n;i+=4)t.push(4294967296*e.random()|0);return new s.init(t,n)}}),a=t.enc={},o=a.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;i<e;i++){var r=n[i>>>2]>>>24-i%4*8&255;t.push((r>>>4).toString(16)),t.push((15&r).toString(16))}return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i+=2)t[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(t,n/2)}},d=a.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],i=0;i<e;i++)t.push(String.fromCharCode(n[i>>>2]>>>24-i%4*8&255));return t.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i++)t[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(t,n)}},u=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},l=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var t=this._data,i=t.words,r=t.sigBytes,a=this.blockSize,o=r/(4*a);if(n=(o=n?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,r=e.min(4*n,r),n){for(var d=0;d<n;d+=a)this._doProcessBlock(i,d);d=i.splice(0,n),t.sigBytes-=r}return new s.init(d,r)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=l.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,t){return new e.init(t).finalize(n)}},_createHmacHelper:function(e){return function(n,t){return new c.HMAC.init(e,t).finalize(n)}}});var c=t.algo={};return t}(Math);!function(e){function n(e){return 4294967296*(e-(0|e))|0}for(var t=i,r=(a=t.lib).WordArray,s=a.Hasher,a=t.algo,o=[],d=[],u=2,l=0;l<64;){var c;e:{c=u;for(var v=e.sqrt(c),g=2;g<=v;g++)if(!(c%g)){c=!1;break e}c=!0}c&&(l<8&&(o[l]=n(e.pow(u,.5))),d[l]=n(e.pow(u,1/3)),l++),u++}var f=[];a=a.SHA256=s.extend({_doReset:function(){this._hash=new r.init(o.slice(0))},_doProcessBlock:function(e,n){for(var t=this._hash.words,i=t[0],r=t[1],s=t[2],a=t[3],o=t[4],u=t[5],l=t[6],c=t[7],v=0;v<64;v++){if(v<16)f[v]=0|e[n+v];else{var g=f[v-15],m=f[v-2];f[v]=((g<<25|g>>>7)^(g<<14|g>>>18)^g>>>3)+f[v-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+f[v-16]}g=c+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&u^~o&l)+d[v]+f[v],m=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&s^r&s),c=l,l=u,u=o,o=a+g|0,a=s,s=r,r=i,i=g+m|0}t[0]=t[0]+i|0,t[1]=t[1]+r|0,t[2]=t[2]+s|0,t[3]=t[3]+a|0,t[4]=t[4]+o|0,t[5]=t[5]+u|0,t[6]=t[6]+l|0,t[7]=t[7]+c|0},_doFinalize:function(){var n=this._data,t=n.words,i=8*this._nDataBytes,r=8*n.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=e.floor(i/4294967296),t[15+(64+r>>>9<<4)]=i,n.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),t.SHA256=s._createHelper(a),t.HmacSHA256=s._createHmacHelper(a)}(Math),t=i.enc.Utf8,i.algo.HMAC=i.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var i=e.blockSize,r=4*i;n.sigBytes>r&&(n=e.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),a=this._iKey=n.clone(),o=s.words,d=a.words,u=0;u<i;u++)o[u]^=1549556828,d[u]^=909522486;s.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher;return e=n.finalize(e),n.reset(),n.finalize(this._oKey.clone().concat(e))}}),n=i.lib.WordArray,i.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,i=this._map;e.clamp(),e=[];for(var r=0;r<t;r+=3)for(var s=(n[r>>>2]>>>24-r%4*8&255)<<16|(n[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|n[r+2>>>2]>>>24-(r+2)%4*8&255,a=0;a<4&&r+.75*a<t;a++)e.push(i.charAt(s>>>6*(3-a)&63));if(n=i.charAt(64))for(;e.length%4;)e.push(n);return e.join("")},parse:function(e){var t=e.length,i=this._map;!(r=i.charAt(64))||-1!=(r=e.indexOf(r))&&(t=r);for(var r=[],s=0,a=0;a<t;a++)if(a%4){var o=i.indexOf(e.charAt(a-1))<<a%4*2,d=i.indexOf(e.charAt(a))>>>6-a%4*2;r[s>>>2]|=(o|d)<<24-s%4*8,s++}return n.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){var n,t,i,r,s,a,o,d,u,l,c,v,g;(n=e.EGAErrorSeverity||(e.EGAErrorSeverity={}))[n.Undefined=0]="Undefined",n[n.Debug=1]="Debug",n[n.Info=2]="Info",n[n.Warning=3]="Warning",n[n.Error=4]="Error",n[n.Critical=5]="Critical",(t=e.EGAProgressionStatus||(e.EGAProgressionStatus={}))[t.Undefined=0]="Undefined",t[t.Start=1]="Start",t[t.Complete=2]="Complete",t[t.Fail=3]="Fail",(i=e.EGAResourceFlowType||(e.EGAResourceFlowType={}))[i.Undefined=0]="Undefined",i[i.Source=1]="Source",i[i.Sink=2]="Sink",(r=e.EGAAdAction||(e.EGAAdAction={}))[r.Undefined=0]="Undefined",r[r.Clicked=1]="Clicked",r[r.Show=2]="Show",r[r.FailedShow=3]="FailedShow",r[r.RewardReceived=4]="RewardReceived",(s=e.EGAAdError||(e.EGAAdError={}))[s.Undefined=0]="Undefined",s[s.Unknown=1]="Unknown",s[s.Offline=2]="Offline",s[s.NoFill=3]="NoFill",s[s.InternalError=4]="InternalError",s[s.InvalidRequest=5]="InvalidRequest",s[s.UnableToPrecache=6]="UnableToPrecache",(a=e.EGAAdType||(e.EGAAdType={}))[a.Undefined=0]="Undefined",a[a.Video=1]="Video",a[a.RewardedVideo=2]="RewardedVideo",a[a.Playable=3]="Playable",a[a.Interstitial=4]="Interstitial",a[a.OfferWall=5]="OfferWall",a[a.Banner=6]="Banner",(d=(o=e.http||(e.http={})).EGAHTTPApiResponse||(o.EGAHTTPApiResponse={}))[d.NoResponse=0]="NoResponse",d[d.BadResponse=1]="BadResponse",d[d.RequestTimeout=2]="RequestTimeout",d[d.JsonEncodeFailed=3]="JsonEncodeFailed",d[d.JsonDecodeFailed=4]="JsonDecodeFailed",d[d.InternalServerError=5]="InternalServerError",d[d.BadRequest=6]="BadRequest",d[d.Unauthorized=7]="Unauthorized",d[d.UnknownResponseCode=8]="UnknownResponseCode",d[d.Ok=9]="Ok",d[d.Created=10]="Created",(l=(u=e.events||(e.events={})).EGASdkErrorCategory||(u.EGASdkErrorCategory={}))[l.Undefined=0]="Undefined",l[l.EventValidation=1]="EventValidation",l[l.Database=2]="Database",l[l.Init=3]="Init",l[l.Http=4]="Http",l[l.Json=5]="Json",(c=u.EGASdkErrorArea||(u.EGASdkErrorArea={}))[c.Undefined=0]="Undefined",c[c.BusinessEvent=1]="BusinessEvent",c[c.ResourceEvent=2]="ResourceEvent",c[c.ProgressionEvent=3]="ProgressionEvent",c[c.DesignEvent=4]="DesignEvent",c[c.ErrorEvent=5]="ErrorEvent",c[c.InitHttp=9]="InitHttp",c[c.EventsHttp=10]="EventsHttp",c[c.ProcessEvents=11]="ProcessEvents",c[c.AddEventsToStore=12]="AddEventsToStore",c[c.AdEvent=20]="AdEvent",(v=u.EGASdkErrorAction||(u.EGASdkErrorAction={}))[v.Undefined=0]="Undefined",v[v.InvalidCurrency=1]="InvalidCurrency",v[v.InvalidShortString=2]="InvalidShortString",v[v.InvalidEventPartLength=3]="InvalidEventPartLength",v[v.InvalidEventPartCharacters=4]="InvalidEventPartCharacters",v[v.InvalidStore=5]="InvalidStore",v[v.InvalidFlowType=6]="InvalidFlowType",v[v.StringEmptyOrNull=7]="StringEmptyOrNull",v[v.NotFoundInAvailableCurrencies=8]="NotFoundInAvailableCurrencies",v[v.InvalidAmount=9]="InvalidAmount",v[v.NotFoundInAvailableItemTypes=10]="NotFoundInAvailableItemTypes",v[v.WrongProgressionOrder=11]="WrongProgressionOrder",v[v.InvalidEventIdLength=12]="InvalidEventIdLength",v[v.InvalidEventIdCharacters=13]="InvalidEventIdCharacters",v[v.InvalidProgressionStatus=15]="InvalidProgressionStatus",v[v.InvalidSeverity=16]="InvalidSeverity",v[v.InvalidLongString=17]="InvalidLongString",v[v.DatabaseTooLarge=18]="DatabaseTooLarge",v[v.DatabaseOpenOrCreate=19]="DatabaseOpenOrCreate",v[v.JsonError=25]="JsonError",v[v.FailHttpJsonDecode=29]="FailHttpJsonDecode",v[v.FailHttpJsonEncode=30]="FailHttpJsonEncode",v[v.InvalidAdAction=31]="InvalidAdAction",v[v.InvalidAdType=32]="InvalidAdType",v[v.InvalidString=33]="InvalidString",(g=u.EGASdkErrorParameter||(u.EGASdkErrorParameter={}))[g.Undefined=0]="Undefined",g[g.Currency=1]="Currency",g[g.CartType=2]="CartType",g[g.ItemType=3]="ItemType",g[g.ItemId=4]="ItemId",g[g.Store=5]="Store",g[g.FlowType=6]="FlowType",g[g.Amount=7]="Amount",g[g.Progression01=8]="Progression01",g[g.Progression02=9]="Progression02",g[g.Progression03=10]="Progression03",g[g.EventId=11]="EventId",g[g.ProgressionStatus=12]="ProgressionStatus",g[g.Severity=13]="Severity",g[g.Message=14]="Message",g[g.AdAction=15]="AdAction",g[g.AdType=16]="AdType",g[g.AdSdkName=17]="AdSdkName",g[g.AdPlacement=18]="AdPlacement"}(r=r||{});var r,s,a,o;r.EGAErrorSeverity,r.EGAProgressionStatus,r.EGAResourceFlowType;(function(e){var n,t;(t=n=n||{})[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Debug=3]="Debug";var i=(r.setInfoLog=function(e){r.instance.infoLogEnabled=e},r.setVerboseLog=function(e){r.instance.infoLogVerboseEnabled=e},r.i=function(e){if(r.instance.infoLogEnabled){var t="Info/"+r.Tag+": "+e;r.instance.sendNotificationMessage(t,n.Info)}},r.w=function(e){var t="Warning/"+r.Tag+": "+e;r.instance.sendNotificationMessage(t,n.Warning)},r.e=function(e){var t="Error/"+r.Tag+": "+e;r.instance.sendNotificationMessage(t,n.Error)},r.ii=function(e){if(r.instance.infoLogVerboseEnabled){var t="Verbose/"+r.Tag+": "+e;r.instance.sendNotificationMessage(t,n.Info)}},r.d=function(e){if(r.debugEnabled){var t="Debug/"+r.Tag+": "+e;r.instance.sendNotificationMessage(t,n.Debug)}},r.prototype.sendNotificationMessage=function(e,t){switch(t){case n.Error:console.error(e);break;case n.Warning:console.warn(e);break;case n.Debug:"function"==typeof console.debug?console.debug(e):console.log(e);break;case n.Info:console.log(e)}},r.instance=new r,r.Tag="GameAnalytics",r);function r(){r.debugEnabled=!1}e.GALogger=i})((o=r=r||{}).logging||(o.logging={})),function(e){var n,t,r;function s(){}n=e.utilities||(e.utilities={}),t=e.logging.GALogger,s.getHmac=function(e,n){var t=i.HmacSHA256(n,e);return i.enc.Base64.stringify(t)},s.stringMatch=function(e,n){return!(!e||!n)&&n.test(e)},s.joinStringArray=function(e,n){for(var t="",i=0,r=e.length;i<r;i++)0<i&&(t+=n),t+=e[i];return t},s.stringArrayContainsString=function(e,n){if(0===e.length)return!1;for(var t in e)if(e[t]===n)return!0;return!1},s.encode64=function(e){e=encodeURI(e);for(var n,t,i,r,a,o="",d=0,u=0,l=0;i=(n=e.charCodeAt(l++))>>2,r=(3&n)<<4|(t=e.charCodeAt(l++))>>4,a=(15&t)<<2|(d=e.charCodeAt(l++))>>6,u=63&d,isNaN(t)?a=u=64:isNaN(d)&&(u=64),o=o+s.keyStr.charAt(i)+s.keyStr.charAt(r)+s.keyStr.charAt(a)+s.keyStr.charAt(u),n=t=d=0,i=r=a=u=0,l<e.length;);return o},s.decode64=function(e){var n,i,r,a,o="",d=0,u=0,l=0;for(/[^A-Za-z0-9\+\/\=]/g.exec(e)&&t.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");n=s.keyStr.indexOf(e.charAt(l++))<<2|(r=s.keyStr.indexOf(e.charAt(l++)))>>4,i=(15&r)<<4|(a=s.keyStr.indexOf(e.charAt(l++)))>>2,d=(3&a)<<6|(u=s.keyStr.indexOf(e.charAt(l++))),o+=String.fromCharCode(n),64!=a&&(o+=String.fromCharCode(i)),64!=u&&(o+=String.fromCharCode(d)),n=i=d=0,r=a=u=0,l<e.length;);return decodeURI(o)},s.timeIntervalSince1970=function(){var e=new Date;return Math.round(e.getTime()/1e3)},s.createGuid=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},s.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=s,n.GAUtilities=r}(r=r||{}),function(e){var n=a.logging.GALogger,t=a.utilities.GAUtilities,i=a.events.EGASdkErrorCategory,r=a.events.EGASdkErrorArea,s=a.events.EGASdkErrorAction,o=a.events.EGASdkErrorParameter,d=function(e,n,t,i,r){this.category=e,this.area=n,this.action=t,this.parameter=i,this.reason=r};e.ValidationResult=d;var u=(l.validateBusinessEvent=function(e,t,a,u,c){return l.validateCurrency(e)?t<0?(n.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: "+t),new d(i.EventValidation,r.BusinessEvent,s.InvalidAmount,o.Amount,t+"")):l.validateShortString(a,!0)?l.validateEventPartLength(u,!1)?l.validateEventPartCharacters(u)?l.validateEventPartLength(c,!1)?l.validateEventPartCharacters(c)?null:(n.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+c),new d(i.EventValidation,r.BusinessEvent,s.InvalidEventPartCharacters,o.ItemId,c)):(n.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: "+c),new d(i.EventValidation,r.BusinessEvent,s.InvalidEventPartLength,o.ItemId,c)):(n.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+u),new d(i.EventValidation,r.BusinessEvent,s.InvalidEventPartCharacters,o.ItemType,u)):(n.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: "+u),new d(i.EventValidation,r.BusinessEvent,s.InvalidEventPartLength,o.ItemType,u)):(n.w("Validation fail - business event - cartType. Cannot be above 32 length. String: "+a),new d(i.EventValidation,r.BusinessEvent,s.InvalidShortString,o.CartType,a)):(n.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: "+e),new d(i.EventValidation,r.BusinessEvent,s.InvalidCurrency,o.Currency,e))},l.validateResourceEvent=function(e,u,c,v,g,f,m){return e==a.EGAResourceFlowType.Undefined?(n.w("Validation fail - resource event - flowType: Invalid flow type."),new d(i.EventValidation,r.ResourceEvent,s.InvalidFlowType,o.FlowType,"")):u?t.stringArrayContainsString(f,u)?0<c?v?l.validateEventPartLength(v,!1)?l.validateEventPartCharacters(v)?t.stringArrayContainsString(m,v)?l.validateEventPartLength(g,!1)?l.validateEventPartCharacters(g)?null:(n.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+g),new d(i.EventValidation,r.ResourceEvent,s.InvalidEventPartCharacters,o.ItemId,g)):(n.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: "+g),new d(i.EventValidation,r.ResourceEvent,s.InvalidEventPartLength,o.ItemId,g)):(n.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: "+v),new d(i.EventValidation,r.ResourceEvent,s.NotFoundInAvailableItemTypes,o.ItemType,v)):(n.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+v),new d(i.EventValidation,r.ResourceEvent,s.InvalidEventPartCharacters,o.ItemType,v)):(n.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: "+v),new d(i.EventValidation,r.ResourceEvent,s.InvalidEventPartLength,o.ItemType,v)):(n.w("Validation fail - resource event - itemType: Cannot be (null)"),new d(i.EventValidation,r.ResourceEvent,s.StringEmptyOrNull,o.ItemType,"")):(n.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: "+c),new d(i.EventValidation,r.ResourceEvent,s.InvalidAmount,o.Amount,c+"")):(n.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: "+u),new d(i.EventValidation,r.ResourceEvent,s.NotFoundInAvailableCurrencies,o.Currency,u)):(n.w("Validation fail - resource event - currency: Cannot be (null)"),new d(i.EventValidation,r.ResourceEvent,s.StringEmptyOrNull,o.Currency,""))},l.validateProgressionEvent=function(e,t,u,c){if(e==a.EGAProgressionStatus.Undefined)return n.w("Validation fail - progression event: Invalid progression status."),new d(i.EventValidation,r.ProgressionEvent,s.InvalidProgressionStatus,o.ProgressionStatus,"");if(c&&!u&&t)return n.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),new d(i.EventValidation,r.ProgressionEvent,s.WrongProgressionOrder,o.Undefined,t+":"+u+":"+c);if(u&&!t)return n.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),new d(i.EventValidation,r.ProgressionEvent,s.WrongProgressionOrder,o.Undefined,t+":"+u+":"+c);if(!t)return n.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),new d(i.EventValidation,r.ProgressionEvent,s.WrongProgressionOrder,o.Undefined,(t||"")+":"+(u||"")+":"+(c||""));if(!l.validateEventPartLength(t,!1))return n.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: "+t),new d(i.EventValidation,r.ProgressionEvent,s.InvalidEventPartLength,o.Progression01,t);if(!l.validateEventPartCharacters(t))return n.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+t),new d(i.EventValidation,r.ProgressionEvent,s.InvalidEventPartCharacters,o.Progression01,t);if(u){if(!l.validateEventPartLength(u,!0))return n.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: "+u),new d(i.EventValidation,r.ProgressionEvent,s.InvalidEventPartLength,o.Progression02,u);if(!l.validateEventPartCharacters(u))return n.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+u),new d(i.EventValidation,r.ProgressionEvent,s.InvalidEventPartCharacters,o.Progression02,u)}if(c){if(!l.validateEventPartLength(c,!0))return n.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: "+c),new d(i.EventValidation,r.ProgressionEvent,s.InvalidEventPartLength,o.Progression03,c);if(!l.validateEventPartCharacters(c))return n.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+c),new d(i.EventValidation,r.ProgressionEvent,s.InvalidEventPartCharacters,o.Progression03,c)}return null},l.validateDesignEvent=function(e){return l.validateEventIdLength(e)?l.validateEventIdCharacters(e)?null:(n.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: "+e),new d(i.EventValidation,r.DesignEvent,s.InvalidEventIdCharacters,o.EventId,e)):(n.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 64 characters or less. String: "+e),new d(i.EventValidation,r.DesignEvent,s.InvalidEventIdLength,o.EventId,e))},l.validateErrorEvent=function(e,t){return e==a.EGAErrorSeverity.Undefined?(n.w("Validation fail - error event - severity: Severity was unsupported value."),new d(i.EventValidation,r.ErrorEvent,s.InvalidSeverity,o.Severity,"")):l.validateLongString(t,!0)?null:(n.w("Validation fail - error event - message: Message cannot be above 8192 characters."),new d(i.EventValidation,r.ErrorEvent,s.InvalidLongString,o.Message,t))},l.validateAdEvent=function(e,t,u,c){return e==a.EGAAdAction.Undefined?(n.w("Validation fail - error event - severity: Severity was unsupported value."),new d(i.EventValidation,r.AdEvent,s.InvalidAdAction,o.AdAction,"")):t==a.EGAAdType.Undefined?(n.w("Validation fail - ad event - adType: Ad type was unsupported value."),new d(i.EventValidation,r.AdEvent,s.InvalidAdType,o.AdType,"")):l.validateShortString(u,!1)?l.validateString(c,!1)?null:(n.w("Validation fail - ad event - message: Ad placement cannot be above 64 characters."),new d(i.EventValidation,r.AdEvent,s.InvalidString,o.AdPlacement,c)):(n.w("Validation fail - ad event - message: Ad SDK name cannot be above 32 characters."),new d(i.EventValidation,r.AdEvent,s.InvalidShortString,o.AdSdkName,u))},l.validateSdkErrorEvent=function(e,t,a,o,d){return!(!l.validateKeys(e,t)||(a===i.Undefined?(n.w("Validation fail - sdk error event - type: Category was unsupported value."),1):o===r.Undefined?(n.w("Validation fail - sdk error event - type: Area was unsupported value."),1):d===s.Undefined&&(n.w("Validation fail - sdk error event - type: Action was unsupported value."),1)))},l.validateKeys=function(e,n){return!(!t.stringMatch(e,/^[A-z0-9]{32}$/)||!t.stringMatch(n,/^[A-z0-9]{40}$/))},l.validateCurrency=function(e){return!!e&&!!t.stringMatch(e,/^[A-Z]{3}$/)},l.validateEventPartLength=function(e,n){return!(!n||e)||!!e&&!(64<e.length)},l.validateEventPartCharacters=function(e){return!!t.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)},l.validateEventIdLength=function(e){return!!e&&!!t.stringMatch(e,/^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)},l.validateEventIdCharacters=function(e){return!!e&&!!t.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)},l.validateAndCleanInitRequestResponse=function(e,t){if(null==e)return n.w("validateInitRequestResponse failed - no response dictionary."),null;var i={};try{var r=e.server_ts;if(!(0<r))return n.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),null;i.server_ts=r}catch(t){return n.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type="+typeof e.server_ts+", value="+e.server_ts+", "+t),null}if(t){try{var s=e.configs;i.configs=s}catch(t){return n.w("validateInitRequestResponse failed - invalid type in 'configs' field. type="+typeof e.configs+", value="+e.configs+", "+t),null}try{var a=e.configs_hash;i.configs_hash=a}catch(t){return n.w("validateInitRequestResponse failed - invalid type in 'configs_hash' field. type="+typeof e.configs_hash+", value="+e.configs_hash+", "+t),null}try{var o=e.ab_id;i.ab_id=o}catch(t){return n.w("validateInitRequestResponse failed - invalid type in 'ab_id' field. type="+typeof e.ab_id+", value="+e.ab_id+", "+t),null}try{var d=e.ab_variant_id;i.ab_variant_id=d}catch(t){return n.w("validateInitRequestResponse failed - invalid type in 'ab_variant_id' field. type="+typeof e.ab_variant_id+", value="+e.ab_variant_id+", "+t),null}}return i},l.validateBuild=function(e){return!!l.validateShortString(e,!1)},l.validateSdkWrapperVersion=function(e){return!!t.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold|godot|flutter) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)},l.validateEngineVersion=function(e){return!(!e||!t.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold|godot) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/))},l.validateUserId=function(e){return!!l.validateString(e,!1)||(n.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),!1)},l.validateShortString=function(e,n){return!(!n||e)||!(!e||32<e.length)},l.validateString=function(e,n){return!(!n||e)||!(!e||64<e.length)},l.validateLongString=function(e,n){return!(!n||e)||!(!e||8192<e.length)},l.validateConnectionType=function(e){return t.stringMatch(e,/^(wwan|wifi|lan|offline)$/)},l.validateCustomDimensions=function(e){return l.validateArrayOfStrings(20,32,!1,"custom dimensions",e)},l.validateResourceCurrencies=function(e){if(!l.validateArrayOfStrings(20,64,!1,"resource currencies",e))return!1;for(var i=0;i<e.length;++i)if(!t.stringMatch(e[i],/^[A-Za-z]+$/))return n.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: "+e[i]),!1;return!0},l.validateResourceItemTypes=function(e){if(!l.validateArrayOfStrings(20,32,!1,"resource item types",e))return!1;for(var t=0;t<e.length;++t)if(!l.validateEventPartCharacters(e[t]))return n.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: "+e[t]),!1;return!0},l.validateDimension01=function(e,n){return!e||!!t.stringArrayContainsString(n,e)},l.validateDimension02=function(e,n){return!e||!!t.stringArrayContainsString(n,e)},l.validateDimension03=function(e,n){return!e||!!t.stringArrayContainsString(n,e)},l.validateArrayOfStrings=function(e,t,i,r,s){var a=r;if(a=a||"Array",!s)return n.w(a+" validation failed: array cannot be null. "),!1;if(0==i&&0==s.length)return n.w(a+" validation failed: array cannot be empty. "),!1;if(0<e&&s.length>e)return n.w(a+" validation failed: array cannot exceed "+e+" values. It has "+s.length+" values."),!1;for(var o=0;o<s.length;++o){var d=s[o]?s[o].length:0;if(0===d)return n.w(a+" validation failed: contained an empty string. Array="+JSON.stringify(s)),!1;if(0<t&&t<d)return n.w(a+" validation failed: a string exceeded max allowed length (which is: "+t+"). String was: "+s[o]),!1}return!0},l.validateClientTs=function(e){return!(e<0||99999999999<e)},l);function l(){}e.GAValidator=u}((a=r=r||{}).validators||(a.validators={})),function(e){!function(e){var n=function(e,n,t){this.name=e,this.value=n,this.version=t};e.NameValueVersion=n;var t=function(e,n){this.name=e,this.version=n};e.NameVersion=t;var i=(r.touch=function(){},r.getRelevantSdkVersion=function(){return r.sdkGameEngineVersion?r.sdkGameEngineVersion:r.sdkWrapperVersion},r.getConnectionType=function(){return r.connectionType},r.updateConnectionType=function(){navigator.onLine?r.connectionType="ios"===r.buildPlatform||"android"===r.buildPlatform?"wwan":"lan":r.connectionType="offline"},r.getOSVersionString=function(){return r.buildPlatform+" "+r.osVersionPair.version},r.runtimePlatformToString=function(){return r.osVersionPair.name},r.getBrowserVersionString=function(){var e,n=navigator.userAgent,t=n.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i)||[];if(0==t.length&&"ios"===r.buildPlatform)return"webkit_"+r.osVersion;if(/trident/i.test(t[1]))return"IE "+((e=/\brv[ :]+(\d+)/g.exec(n)||[])[1]||"");if("Chrome"===t[1]&&null!=(e=n.match(/\b(OPR|Edge|UBrowser)\/(\d+)/)))return e.slice(1).join(" ").replace("OPR","Opera").replace("UBrowser","UC").toLowerCase();if(t[1]&&"fbav"===t[1].toLowerCase()&&(t[1]="facebook",t[2]))return"facebook "+t[2];var i=t[2]?[t[1],t[2]]:[navigator.appName,navigator.appVersion,"-?"];return null!=(e=n.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),i.join(" ").toLowerCase()},r.getDeviceModel=function(){return"unknown"},r.getDeviceManufacturer=function(){return"unknown"},r.matchItem=function(e,n){var i,r,s,a,o=new t("unknown","0.0.0"),d=0,u=0;for(d=0;d<n.length;d+=1)if(new RegExp(n[d].value,"i").test(e)){if(i=new RegExp(n[d].version+"[- /:;]([\\d._]+)","i"),a="",(r=e.match(i))&&r[1]&&(s=r[1]),s){var l=s.split(/[._]+/);for(u=0;u<Math.min(l.length,3);u+=1)a+=l[u]+(u<Math.min(l.length,3)-1?".":"")}else a="0.0.0";return o.name=n[d].name,o.version=a,o}return o},r.sdkWrapperVersion="javascript 4.4.4",r.osVersionPair=r.matchItem([navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor].join(" "),[new n("windows_phone","Windows Phone","OS"),new n("windows","Win","NT"),new n("ios","iPhone","OS"),new n("ios","iPad","OS"),new n("ios","iPod","OS"),new n("android","Android","Android"),new n("blackBerry","BlackBerry","/"),new n("mac_osx","Mac","OS X"),new n("tizen","Tizen","Tizen"),new n("linux","Linux","rv"),new n("kai_os","KAIOS","KAIOS")]),r.buildPlatform=r.runtimePlatformToString(),r.deviceModel=r.getDeviceModel(),r.deviceManufacturer=r.getDeviceManufacturer(),r.osVersion=r.getOSVersionString(),r.browserVersion=r.getBrowserVersionString(),r);function r(){}e.GADevice=i}(e.device||(e.device={}))}(r=r||{}),function(e){var n,t;function i(e){this.deadline=e,this.ignore=!1,this.async=!1,this.running=!1,this.id=++i.idCounter}n=e.threading||(e.threading={}),i.idCounter=0,t=i,n.TimedBlock=t}(r=r||{}),function(e){var n,t;function i(e){this.comparer=e,this._subQueues={},this._sortedKeys=[]}n=e.threading||(e.threading={}),i.prototype.enqueue=function(e,n){-1===this._sortedKeys.indexOf(e)&&this.addQueueOfPriority(e),this._subQueues[e].push(n)},i.prototype.addQueueOfPriority=function(e){var n=this;this._sortedKeys.push(e),this._sortedKeys.sort((function(e,t){return n.comparer.compare(e,t)})),this._subQueues[e]=[]},i.prototype.peek=function(){if(this.hasItems())return this._subQueues[this._sortedKeys[0]][0];throw new Error("The queue is empty")},i.prototype.hasItems=function(){return 0<this._sortedKeys.length},i.prototype.dequeue=function(){if(this.hasItems())return this.dequeueFromHighPriorityQueue();throw new Error("The queue is empty")},i.prototype.dequeueFromHighPriorityQueue=function(){var e=this._sortedKeys[0],n=this._subQueues[e].shift();return 0===this._subQueues[e].length&&(this._sortedKeys.shift(),delete this._subQueues[e]),n},t=i,n.PriorityQueue=t}(r=r||{}),function(e){var n,t,i,r,a=s.logging.GALogger;(t=n=e.EGAStoreArgsOperator||(e.EGAStoreArgsOperator={}))[t.Equal=0]="Equal",t[t.LessOrEqual=1]="LessOrEqual",t[t.NotEqual=2]="NotEqual",(r=i=e.EGAStore||(e.EGAStore={}))[r.Events=0]="Events",r[r.Sessions=1]="Sessions",r[r.Progression=2]="Progression";var o=(d.isStorageAvailable=function(){return d.storageAvailable},d.isStoreTooLargeForEvents=function(){return d.instance.eventsStore.length+d.instance.sessionsStore.length>d.MaxNumberOfEntries},d.select=function(e,t,i,r){void 0===t&&(t=[]),void 0===i&&(i=!1),void 0===r&&(r=0);var s=d.getStore(e);if(!s)return null;for(var a=[],o=0;o<s.length;++o){for(var u=s[o],l=!0,c=0;c<t.length;++c){var v=t[c];if(u[v[0]])switch(v[1]){case n.Equal:l=u[v[0]]==v[2];break;case n.LessOrEqual:l=u[v[0]]<=v[2];break;case n.NotEqual:l=u[v[0]]!=v[2];break;default:l=!1}else l=!1;if(!l)break}l&&a.push(u)}return i&&a.sort((function(e,n){return e.client_ts-n.client_ts})),0<r&&a.length>r&&(a=a.slice(0,r+1)),a},d.update=function(e,t,i){void 0===i&&(i=[]);var r=d.getStore(e);if(!r)return!1;for(var s=0;s<r.length;++s){for(var a=r[s],o=!0,u=0;u<i.length;++u){var l=i[u];if(a[l[0]])switch(l[1]){case n.Equal:o=a[l[0]]==l[2];break;case n.LessOrEqual:o=a[l[0]]<=l[2];break;case n.NotEqual:o=a[l[0]]!=l[2];break;default:o=!1}else o=!1;if(!o)break}if(o)for(u=0;u<t.length;++u){var c=t[u];a[c[0]]=c[1]}}return!0},d.delete=function(e,t){var i=d.getStore(e);if(i)for(var r=0;r<i.length;++r){for(var s=i[r],a=!0,o=0;o<t.length;++o){var u=t[o];if(s[u[0]])switch(u[1]){case n.Equal:a=s[u[0]]==u[2];break;case n.LessOrEqual:a=s[u[0]]<=u[2];break;case n.NotEqual:a=s[u[0]]!=u[2];break;default:a=!1}else a=!1;if(!a)break}a&&(i.splice(r,1),--r)}},d.insert=function(e,n,t,i){void 0===t&&(t=!1),void 0===i&&(i=null);var r=d.getStore(e);if(r)if(t){if(!i)return;for(var s=!1,a=0;a<r.length;++a){var o=r[a];if(o[i]==n[i]){for(var u in n)o[u]=n[u];s=!0;break}}s||r.push(n)}else r.push(n)},d.save=function(e){d.isStorageAvailable()?(localStorage.setItem(d.StringFormat(d.KeyFormat,e,d.EventsStoreKey),JSON.stringify(d.instance.eventsStore)),localStorage.setItem(d.StringFormat(d.KeyFormat,e,d.SessionsStoreKey),JSON.stringify(d.instance.sessionsStore)),localStorage.setItem(d.StringFormat(d.KeyFormat,e,d.ProgressionStoreKey),JSON.stringify(d.instance.progressionStore)),localStorage.setItem(d.StringFormat(d.KeyFormat,e,d.ItemsStoreKey),JSON.stringify(d.instance.storeItems))):a.w("Storage is not available, cannot save.")},d.load=function(e){if(d.isStorageAvailable()){try{d.instance.eventsStore=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,e,d.EventsStoreKey))),d.instance.eventsStore||(d.instance.eventsStore=[])}catch(e){a.w("Load failed for 'events' store. Using empty store."),d.instance.eventsStore=[]}try{d.instance.sessionsStore=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,e,d.SessionsStoreKey))),d.instance.sessionsStore||(d.instance.sessionsStore=[])}catch(e){a.w("Load failed for 'sessions' store. Using empty store."),d.instance.sessionsStore=[]}try{d.instance.progressionStore=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,e,d.ProgressionStoreKey))),d.instance.progressionStore||(d.instance.progressionStore=[])}catch(e){a.w("Load failed for 'progression' store. Using empty store."),d.instance.progressionStore=[]}try{d.instance.storeItems=JSON.parse(localStorage.getItem(d.StringFormat(d.KeyFormat,e,d.ItemsStoreKey))),d.instance.storeItems||(d.instance.storeItems={})}catch(e){a.w("Load failed for 'items' store. Using empty store."),d.instance.progressionStore=[]}}else a.w("Storage is not available, cannot load.")},d.setItem=function(e,n,t){var i=d.StringFormat(d.KeyFormat,e,n);t?d.instance.storeItems[i]=t:i in d.instance.storeItems&&delete d.instance.storeItems[i]},d.getItem=function(e,n){var t=d.StringFormat(d.KeyFormat,e,n);return t in d.instance.storeItems?d.instance.storeItems[t]:null},d.getStore=function(e){switch(e){case i.Events:return d.instance.eventsStore;case i.Sessions:return d.instance.sessionsStore;case i.Progression:return d.instance.progressionStore;default:return a.w("GAStore.getStore(): Cannot find store: "+e),null}},d.instance=new d,d.MaxNumberOfEntries=2e3,d.StringFormat=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return e.replace(/{(\d+)}/g,(function(e,t){return n[t]||""}))},d.KeyFormat="GA::{0}::{1}",d.EventsStoreKey="ga_event",d.SessionsStoreKey="ga_session",d.ProgressionStoreKey="ga_progression",d.ItemsStoreKey="ga_items",d);function d(){this.eventsStore=[],this.sessionsStore=[],this.progressionStore=[],this.storeItems={};try{"object"==typeof localStorage?(localStorage.setItem("testingLocalStorage","yes"),localStorage.removeItem("testingLocalStorage"),d.storageAvailable=!0):d.storageAvailable=!1}catch(e){}}e.GAStore=o}((s=r=r||{}).store||(s.store={})),function(e){var n,t,i,r,s,a,o,d,u;function l(){this.availableCustomDimensions01=[],this.availableCustomDimensions02=[],this.availableCustomDimensions03=[],this.currentGlobalCustomEventFields={},this.availableResourceCurrencies=[],this.availableResourceItemTypes=[],this.configurations={},this.remoteConfigsListeners=[],this.beforeUnloadListeners=[],this.sdkConfigDefault={},this.sdkConfig={},this.progressionTries={},this._isEventSubmissionEnabled=!0,this.isUnloading=!1}n=e.state||(e.state={}),t=e.validators.GAValidator,i=e.utilities.GAUtilities,r=e.logging.GALogger,s=e.store.GAStore,a=e.device.GADevice,o=e.store.EGAStore,d=e.store.EGAStoreArgsOperator,l.setUserId=function(e){l.instance.userId=e,l.cacheIdentifier()},l.getIdentifier=function(){return l.instance.identifier},l.isInitialized=function(){return l.instance.initialized},l.setInitialized=function(e){l.instance.initialized=e},l.getSessionStart=function(){return l.instance.sessionStart},l.getSessionNum=function(){return l.instance.sessionNum},l.getTransactionNum=function(){return l.instance.transactionNum},l.getSessionId=function(){return l.instance.sessionId},l.getCurrentCustomDimension01=function(){return l.instance.currentCustomDimension01},l.getCurrentCustomDimension02=function(){return l.instance.currentCustomDimension02},l.getCurrentCustomDimension03=function(){return l.instance.currentCustomDimension03},l.getGameKey=function(){return l.instance.gameKey},l.getGameSecret=function(){return l.instance.gameSecret},l.getAvailableCustomDimensions01=function(){return l.instance.availableCustomDimensions01},l.setAvailableCustomDimensions01=function(e){t.validateCustomDimensions(e)&&(l.instance.availableCustomDimensions01=e,l.validateAndFixCurrentDimensions(),r.i("Set available custom01 dimension values: ("+i.joinStringArray(e,", ")+")"))},l.getAvailableCustomDimensions02=function(){return l.instance.availableCustomDimensions02},l.setAvailableCustomDimensions02=function(e){t.validateCustomDimensions(e)&&(l.instance.availableCustomDimensions02=e,l.validateAndFixCurrentDimensions(),r.i("Set available custom02 dimension values: ("+i.joinStringArray(e,", ")+")"))},l.getAvailableCustomDimensions03=function(){return l.instance.availableCustomDimensions03},l.setAvailableCustomDimensions03=function(e){t.validateCustomDimensions(e)&&(l.instance.availableCustomDimensions03=e,l.validateAndFixCurrentDimensions(),r.i("Set available custom03 dimension values: ("+i.joinStringArray(e,", ")+")"))},l.getAvailableResourceCurrencies=function(){return l.instance.availableResourceCurrencies},l.setAvailableResourceCurrencies=function(e){t.validateResourceCurrencies(e)&&(l.instance.availableResourceCurrencies=e,r.i("Set available resource currencies: ("+i.joinStringArray(e,", ")+")"))},l.getAvailableResourceItemTypes=function(){return l.instance.availableResourceItemTypes},l.setAvailableResourceItemTypes=function(e){t.validateResourceItemTypes(e)&&(l.instance.availableResourceItemTypes=e,r.i("Set available resource item types: ("+i.joinStringArray(e,", ")+")"))},l.getBuild=function(){return l.instance.build},l.setBuild=function(e){l.instance.build=e,r.i("Set build version: "+e)},l.getUseManualSessionHandling=function(){return l.instance.useManualSessionHandling},l.isEventSubmissionEnabled=function(){return l.instance._isEventSubmissionEnabled},l.getABTestingId=function(){return l.instance.abId},l.getABTestingVariantId=function(){return l.instance.abVariantId},l.prototype.setDefaultId=function(e){this.defaultUserId=e||"",l.cacheIdentifier()},l.getDefaultId=function(){return l.instance.defaultUserId},l.getSdkConfig=function(){var e,n=0;for(var t in l.instance.sdkConfig)0===n&&(e=t),++n;if(e&&0<n)return l.instance.sdkConfig;for(var t in n=0,l.instance.sdkConfigCached)0===n&&(e=t),++n;return e&&0<n?l.instance.sdkConfigCached:l.instance.sdkConfigDefault},l.isEnabled=function(){return!!l.instance.initAuthorized},l.setCustomDimension01=function(e){l.instance.currentCustomDimension01=e,s.setItem(l.getGameKey(),l.Dimension01Key,e),r.i("Set custom01 dimension value: "+e)},l.setCustomDimension02=function(e){l.instance.currentCustomDimension02=e,s.setItem(l.getGameKey(),l.Dimension02Key,e),r.i("Set custom02 dimension value: "+e)},l.setCustomDimension03=function(e){l.instance.currentCustomDimension03=e,s.setItem(l.getGameKey(),l.Dimension03Key,e),r.i("Set custom03 dimension value: "+e)},l.incrementSessionNum=function(){var e=l.getSessionNum()+1;l.instance.sessionNum=e},l.incrementTransactionNum=function(){var e=l.getTransactionNum()+1;l.instance.transactionNum=e},l.incrementProgressionTries=function(e){var n=l.getProgressionTries(e)+1;l.instance.progressionTries[e]=n;var t={};t.progression=e,t.tries=n,s.insert(o.Progression,t,!0,"progression")},l.getProgressionTries=function(e){return e in l.instance.progressionTries?l.instance.progressionTries[e]:0},l.clearProgressionTries=function(e){e in l.instance.progressionTries&&delete l.instance.progressionTries[e];var n=[];n.push(["progression",d.Equal,e]),s.delete(o.Progression,n)},l.setKeys=function(e,n){l.instance.gameKey=e,l.instance.gameSecret=n},l.setManualSessionHandling=function(e){l.instance.useManualSessionHandling=e,r.i("Use manual session handling: "+e)},l.setEnabledEventSubmission=function(e){l.instance._isEventSubmissionEnabled=e},l.getEventAnnotations=function(){var e={v:2};e.event_uuid=i.createGuid(),e.user_id=l.instance.identifier,e.client_ts=l.getClientTsAdjusted(),e.sdk_version=a.getRelevantSdkVersion(),e.os_version=a.osVersion,e.manufacturer=a.deviceManufacturer,e.device=a.deviceModel,e.browser_version=a.browserVersion,e.platform=a.buildPlatform,e.session_id=l.instance.sessionId,e[l.SessionNumKey]=l.instance.sessionNum;var n=a.getConnectionType();if(t.validateConnectionType(n)&&(e.connection_type=n),a.gameEngineVersion&&(e.engine_version=a.gameEngineVersion),l.instance.configurations){var r=0;for(var s in l.instance.configurations){r++;break}0<r&&(e.configurations=l.instance.configurations)}return l.instance.abId&&(e.ab_id=l.instance.abId),l.instance.abVariantId&&(e.ab_variant_id=l.instance.abVariantId),l.instance.build&&(e.build=l.instance.build),e},l.getSdkErrorEventAnnotations=function(){var e={v:2};e.event_uuid=i.createGuid(),e.category=l.CategorySdkError,e.sdk_version=a.getRelevantSdkVersion(),e.os_version=a.osVersion,e.manufacturer=a.deviceManufacturer,e.device=a.deviceModel,e.platform=a.buildPlatform;var n=a.getConnectionType();return t.validateConnectionType(n)&&(e.connection_type=n),a.gameEngineVersion&&(e.engine_version=a.gameEngineVersion),e},l.getInitAnnotations=function(){var e={};return l.getIdentifier()||l.cacheIdentifier(),s.setItem(l.getGameKey(),l.LastUsedIdentifierKey,l.getIdentifier()),e.user_id=l.getIdentifier(),e.sdk_version=a.getRelevantSdkVersion(),e.os_version=a.osVersion,e.platform=a.buildPlatform,l.getBuild()?e.build=l.getBuild():e.build=null,e.session_num=l.getSessionNum(),e.random_salt=l.getSessionNum(),e},l.getClientTsAdjusted=function(){var e=i.timeIntervalSince1970(),n=e+l.instance.clientServerTimeOffset;return t.validateClientTs(n)?n:e},l.sessionIsStarted=function(){return 0!=l.instance.sessionStart},l.cacheIdentifier=function(){l.instance.userId?l.instance.identifier=l.instance.userId:l.instance.defaultUserId&&(l.instance.identifier=l.instance.defaultUserId)},l.ensurePersistedStates=function(){s.isStorageAvailable()&&s.load(l.getGameKey());var e=l.instance;e.setDefaultId(null!=s.getItem(l.getGameKey(),l.DefaultUserIdKey)?s.getItem(l.getGameKey(),l.DefaultUserIdKey):i.createGuid()),e.sessionNum=null!=s.getItem(l.getGameKey(),l.SessionNumKey)?Number(s.getItem(l.getGameKey(),l.SessionNumKey)):0,e.transactionNum=null!=s.getItem(l.getGameKey(),l.TransactionNumKey)?Number(s.getItem(l.getGameKey(),l.TransactionNumKey)):0,e.currentCustomDimension01?s.setItem(l.getGameKey(),l.Dimension01Key,e.currentCustomDimension01):(e.currentCustomDimension01=null!=s.getItem(l.getGameKey(),l.Dimension01Key)?s.getItem(l.getGameKey(),l.Dimension01Key):"",e.currentCustomDimension01),e.currentCustomDimension02?s.setItem(l.getGameKey(),l.Dimension02Key,e.currentCustomDimension02):(e.currentCustomDimension02=null!=s.getItem(l.getGameKey(),l.Dimension02Key)?s.getItem(l.getGameKey(),l.Dimension02Key):"",e.currentCustomDimension02),e.currentCustomDimension03?s.setItem(l.getGameKey(),l.Dimension03Key,e.currentCustomDimension03):(e.currentCustomDimension03=null!=s.getItem(l.getGameKey(),l.Dimension03Key)?s.getItem(l.getGameKey(),l.Dimension03Key):"",e.currentCustomDimension03);var n=null!=s.getItem(l.getGameKey(),l.SdkConfigCachedKey)?s.getItem(l.getGameKey(),l.SdkConfigCachedKey):"";if(n){var t=JSON.parse(i.decode64(n));if(t){var a=s.getItem(l.getGameKey(),l.LastUsedIdentifierKey);null!=a&&a!=l.getIdentifier()&&(r.w("New identifier spotted compared to last one used, clearing cached configs hash!!"),t.configs_hash&&delete t.configs_hash),e.sdkConfigCached=t}}var d=l.getSdkConfig();e.configsHash=d.configs_hash?d.configs_hash:"",e.abId=d.ab_id?d.ab_id:"",e.abVariantId=d.ab_variant_id?d.ab_variant_id:"";var u=s.select(o.Progression);if(u)for(var c=0;c<u.length;++c){var v=u[c];v&&(e.progressionTries[v.progression]=v.tries)}},l.calculateServerTimeOffset=function(e){return e-i.timeIntervalSince1970()},l.formatString=function(e,n){for(var t=e,i=0;i<n.length;i++){var r=new RegExp("\\{"+i+"\\}","gi");t=t.replace(r,arguments[i])}return t},l.validateAndCleanCustomFields=function(e,n){void 0===n&&(n=null);var t={};if(e){var s=0;for(var a in e){var o=e[a];if(a&&o)if(s<l.MAX_CUSTOM_FIELDS_COUNT){var d=new RegExp("^[a-zA-Z0-9_]{1,"+l.MAX_CUSTOM_FIELDS_KEY_LENGTH+"}$");if(i.stringMatch(a,d)){var u=typeof o;if("string"==u||o instanceof String)o.length<=l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH&&0<o.length?(t[a]=o,++s):(g=l.formatString(v="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its value is an empty string or exceeds the max number of characters ("+l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH+")",[a,o]),r.w(g),n&&n(v,g));else if("number"==u||o instanceof Number){var c=o;t[a]=c,++s}else g=l.formatString(v="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its value is not a string or number",[a,o]),r.w(g),n&&n(v,g)}else g=l.formatString(v="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its key contains illegal character, is empty or exceeds the max number of characters ("+l.MAX_CUSTOM_FIELDS_KEY_LENGTH+")",[a,o]),r.w(g),n&&n(v,g)}else g=l.formatString(v="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because it exceeds the max number of custom fields ("+l.MAX_CUSTOM_FIELDS_COUNT+")",[a,o]),r.w(g),n&&n(v,g);else{var v,g=l.formatString(v="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its key or value is null",[a,o]);r.w(g),n&&n(v,g)}}}return t},l.validateAndFixCurrentDimensions=function(){t.validateDimension01(l.getCurrentCustomDimension01(),l.getAvailableCustomDimensions01())||l.setCustomDimension01(""),t.validateDimension02(l.getCurrentCustomDimension02(),l.getAvailableCustomDimensions02())||l.setCustomDimension02(""),t.validateDimension03(l.getCurrentCustomDimension03(),l.getAvailableCustomDimensions03())||l.setCustomDimension03("")},l.getConfigurationStringValue=function(e,n){return l.instance.configurations[e]?l.instance.configurations[e].toString():n},l.isRemoteConfigsReady=function(){return l.instance.remoteConfigsIsReady},l.addRemoteConfigsListener=function(e){l.instance.remoteConfigsListeners.indexOf(e)<0&&l.instance.remoteConfigsListeners.push(e)},l.removeRemoteConfigsListener=function(e){var n=l.instance.remoteConfigsListeners.indexOf(e);-1<n&&l.instance.remoteConfigsListeners.splice(n,1)},l.getRemoteConfigsContentAsString=function(){return JSON.stringify(l.instance.configurations)},l.populateConfigurations=function(e){var n=e.configs;if(n){l.instance.configurations={};for(var t=0;t<n.length;++t){var i=n[t];if(i){var r=i.key,s=i.value,a=i.start_ts?i.start_ts:Number.MIN_VALUE,o=i.end_ts?i.end_ts:Number.MAX_VALUE,d=l.getClientTsAdjusted();r&&s&&a<d&&d<o&&(l.instance.configurations[r]=s)}}}l.instance.remoteConfigsIsReady=!0;var u=l.instance.remoteConfigsListeners;for(t=0;t<u.length;++t)u[t]&&u[t].onRemoteConfigsUpdated()},l.addOnBeforeUnloadListener=function(e){l.instance.beforeUnloadListeners.indexOf(e)<0&&l.instance.beforeUnloadListeners.push(e)},l.removeOnBeforeUnloadListener=function(e){var n=l.instance.beforeUnloadListeners.indexOf(e);-1<n&&l.instance.beforeUnloadListeners.splice(n,1)},l.notifyBeforeUnloadListeners=function(){for(var e=l.instance.beforeUnloadListeners,n=0;n<e.length;++n)e[n]&&e[n].onBeforeUnload()},l.CategorySdkError="sdk_error",l.MAX_CUSTOM_FIELDS_COUNT=50,l.MAX_CUSTOM_FIELDS_KEY_LENGTH=64,l.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH=256,l.instance=new l,l.DefaultUserIdKey="default_user_id",l.SessionNumKey="session_num",l.TransactionNumKey="transaction_num",l.Dimension01Key="dimension01",l.Dimension02Key="dimension02",l.Dimension03Key="dimension03",l.SdkConfigCachedKey="sdk_config_cached",l.LastUsedIdentifierKey="last_used_identifier",u=l,n.GAState=u}(r=r||{}),function(e){var n,t,i,r;function s(){}n=e.tasks||(e.tasks={}),t=e.utilities.GAUtilities,i=e.logging.GALogger,s.execute=function(e,n,r,a){var o=new Date;if(s.timestampMap[n]||(s.timestampMap[n]=o),s.countMap[n]||(s.countMap[n]=0),3600<=(o.getTime()-s.timestampMap[n].getTime())/1e3&&(s.timestampMap[n]=o,s.countMap[n]=0),!(s.countMap[n]>=s.MaxCount)){var d=t.getHmac(a,r),u=new XMLHttpRequest;u.onreadystatechange=function(){if(4===u.readyState){if(!u.responseText)return;if(200!=u.status)return void i.w("sdk error failed. response code not 200. status code: "+u.status+", description: "+u.statusText+", body: "+u.responseText);s.countMap[n]=s.countMap[n]+1}},u.open("GET","patch/json/null.json?"+e,!0),u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Authorization",d);try{u.send(r)}catch(e){console.error(e)}}},s.MaxCount=10,s.countMap={},s.timestampMap={},r=s,n.SdkErrorTask=r}(r=r||{}),function(e){var n,t,i,r,s,a,o,d,u,l,c;function v(){this.protocol="https",this.hostName="api.gameanalytics.com",this.version="v2",this.remoteConfigsVersion="v1",this.baseUrl="patch/json/null.json?"+this.protocol+"://"+this.hostName+"/"+this.version,this.remoteConfigsBaseUrl="patch/json/null.json?"+this.protocol+"://"+this.hostName+"/remote_configs/"+this.remoteConfigsVersion,this.initializeUrlPath="init",this.eventsUrlPath="events",this.useGzip=!1}n=e.http||(e.http={}),t=e.state.GAState,i=e.logging.GALogger,r=e.utilities.GAUtilities,s=e.validators.GAValidator,a=e.tasks.SdkErrorTask,o=e.events.EGASdkErrorCategory,d=e.events.EGASdkErrorArea,u=e.events.EGASdkErrorAction,l=e.events.EGASdkErrorParameter,v.prototype.requestInit=function(e,i){var r=t.getGameKey(),s=this.remoteConfigsBaseUrl+"/"+this.initializeUrlPath+"?game_key="+r+"&interval_seconds=0&configs_hash="+e,a=t.getInitAnnotations(),o=JSON.stringify(a);if(o){var d=this.createPayloadData(o,this.useGzip),u=[];u.push(o),v.sendRequest(s,d,u,this.useGzip,v.initRequestCallback,i)}else i(n.EGAHTTPApiResponse.JsonEncodeFailed,null)},v.prototype.sendEventsInArray=function(e,i,r){if(0!=e.length){var s=t.getGameKey(),a=this.baseUrl+"/"+s+"/"+this.eventsUrlPath,o=JSON.stringify(e);if(o){var d=this.createPayloadData(o,this.useGzip),u=[];u.push(o),u.push(i),u.push(e.length.toString()),v.sendRequest(a,d,u,this.useGzip,v.sendEventInArrayRequestCallback,r)}else r(n.EGAHTTPApiResponse.JsonEncodeFailed,null,i,e.length)}},v.prototype.sendSdkErrorEvent=function(e,n,r,o,d,u,l){if(t.isEventSubmissionEnabled()&&s.validateSdkErrorEvent(u,l,e,n,r)){var c,g=this.baseUrl+"/"+u+"/"+this.eventsUrlPath,f="",m=t.getSdkErrorEventAnnotations(),E=v.sdkErrorCategoryString(e);f+=m.error_category=E;var p=v.sdkErrorAreaString(n);f+=":"+(m.error_area=p);var h=v.sdkErrorActionString(r);m.error_action=h;var A=v.sdkErrorParameterString(o);if(0<A.length&&(m.error_parameter=A),0<d.length){var S=d;d.length>v.MAX_ERROR_MESSAGE_LENGTH&&(S=d.substring(0,v.MAX_ERROR_MESSAGE_LENGTH)),m.reason=S}var y=[];y.push(m),(c=JSON.stringify(y))?a.execute(g,f,c,l):i.w("sendSdkErrorEvent: JSON encoding failed.")}},v.sendEventInArrayRequestCallback=function(e,i,r,s){void 0===s&&(s=null),s[0],s[1];var a,c,g=s[2],f=parseInt(s[3]);a=e.responseText,c=e.status;var m=v.instance.processRequestResponse(c,e.statusText,a,"Events");if(m==n.EGAHTTPApiResponse.Ok||m==n.EGAHTTPApiResponse.Created||m==n.EGAHTTPApiResponse.BadRequest){var E=a?JSON.parse(a):{};if(null==E)return r(n.EGAHTTPApiResponse.JsonDecodeFailed,null,g,f),void v.instance.sendSdkErrorEvent(o.Http,d.EventsHttp,u.FailHttpJsonDecode,l.Undefined,a,t.getGameKey(),t.getGameSecret());n.EGAHTTPApiResponse.BadRequest,r(m,E,g,f)}else r(m,null,g,f)},v.sendRequest=function(e,n,i,s,a,o){var d=new XMLHttpRequest,u=t.getGameSecret(),l=r.getHmac(u,n),c=[];for(var v in c.push(l),i)c.push(i[v]);if(d.onreadystatechange=function(){4===d.readyState&&a(d,e,o,c)},d.open("GET","patch/json/null.json?"+e,!0),d.setRequestHeader("Content-Type","application/json"),d.setRequestHeader("Authorization",l),s)throw new Error("gzip not supported");try{d.send(n)}catch(e){console.error(e.stack)}},v.initRequestCallback=function(e,i,r,a){var c,g;void 0===a&&(a=null),a[0],a[1],c=e.responseText,g=e.status;var f=c?JSON.parse(c):{},m=v.instance.processRequestResponse(g,e.statusText,c,"Init");if(m==n.EGAHTTPApiResponse.Ok||m==n.EGAHTTPApiResponse.Created||m==n.EGAHTTPApiResponse.BadRequest){if(null==f)return r(n.EGAHTTPApiResponse.JsonDecodeFailed,null,"",0),void v.instance.sendSdkErrorEvent(o.Http,d.InitHttp,u.FailHttpJsonDecode,l.Undefined,c,t.getGameKey(),t.getGameSecret());if(m!==n.EGAHTTPApiResponse.BadRequest){var E=s.validateAndCleanInitRequestResponse(f,m===n.EGAHTTPApiResponse.Created);E?r(m,E,"",0):r(n.EGAHTTPApiResponse.BadResponse,null,"",0)}else r(m,null,"",0)}else r(m,null,"",0)},v.prototype.createPayloadData=function(e,n){if(n)throw new Error("gzip not supported");return e},v.prototype.processRequestResponse=function(e,t,i,r){return i?200===e?n.EGAHTTPApiResponse.Ok:201===e?n.EGAHTTPApiResponse.Created:0===e||401===e?n.EGAHTTPApiResponse.Unauthorized:400===e?n.EGAHTTPApiResponse.BadRequest:500===e?n.EGAHTTPApiResponse.InternalServerError:n.EGAHTTPApiResponse.UnknownResponseCode:n.EGAHTTPApiResponse.NoResponse},v.sdkErrorCategoryString=function(e){switch(e){case o.EventValidation:return"event_validation";case o.Database:return"db";case o.Init:return"init";case o.Http:return"http";case o.Json:return"json"}return""},v.sdkErrorAreaString=function(e){switch(e){case d.BusinessEvent:return"business";case d.ResourceEvent:return"resource";case d.ProgressionEvent:return"progression";case d.DesignEvent:return"design";case d.ErrorEvent:return"error";case d.InitHttp:return"init_http";case d.EventsHttp:return"events_http";case d.ProcessEvents:return"process_events";case d.AddEventsToStore:return"add_events_to_store"}return""},v.sdkErrorActionString=function(e){switch(e){case u.InvalidCurrency:return"invalid_currency";case u.InvalidShortString:return"invalid_short_string";case u.InvalidEventPartLength:return"invalid_event_part_length";case u.InvalidEventPartCharacters:return"invalid_event_part_characters";case u.InvalidStore:return"invalid_store";case u.InvalidFlowType:return"invalid_flow_type";case u.StringEmptyOrNull:return"string_empty_or_null";case u.NotFoundInAvailableCurrencies:return"not_found_in_available_currencies";case u.InvalidAmount:return"invalid_amount";case u.NotFoundInAvailableItemTypes:return"not_found_in_available_item_types";case u.WrongProgressionOrder:return"wrong_progression_order";case u.InvalidEventIdLength:return"invalid_event_id_length";case u.InvalidEventIdCharacters:return"invalid_event_id_characters";case u.InvalidProgressionStatus:return"invalid_progression_status";case u.InvalidSeverity:return"invalid_severity";case u.InvalidLongString:return"invalid_long_string";case u.DatabaseTooLarge:return"db_too_large";case u.DatabaseOpenOrCreate:return"db_open_or_create";case u.JsonError:return"json_error";case u.FailHttpJsonDecode:return"fail_http_json_decode";case u.FailHttpJsonEncode:return"fail_http_json_encode"}return""},v.sdkErrorParameterString=function(e){switch(e){case l.Currency:return"currency";case l.CartType:return"cart_type";case l.ItemType:return"item_type";case l.ItemId:return"item_id";case l.Store:return"store";case l.FlowType:return"flow_type";case l.Amount:return"amount";case l.Progression01:return"progression01";case l.Progression02:return"progression02";case l.Progression03:return"progression03";case l.EventId:return"event_id";case l.ProgressionStatus:return"progression_status";case l.Severity:return"severity";case l.Message:return"message"}return""},v.instance=new v,v.MAX_ERROR_MESSAGE_LENGTH=256,c=v,n.GAHTTPApi=c}(r=r||{}),function(e){var n,t,i,r,s,a,o,d,u,l,c;function v(){}n=e.events||(e.events={}),t=e.store.GAStore,i=e.store.EGAStore,r=e.store.EGAStoreArgsOperator,s=e.state.GAState,a=e.logging.GALogger,o=e.utilities.GAUtilities,d=e.http.EGAHTTPApiResponse,u=e.http.GAHTTPApi,l=e.validators.GAValidator,v.customEventFieldsErrorCallback=function(n,t){if(s.isEventSubmissionEnabled()){var i=new Date;v.timestampMap[n]||(v.timestampMap[n]=i),v.countMap[n]||(v.countMap[n]=0),3600<=(i.getTime()-v.timestampMap[n].getTime())/1e3&&(v.timestampMap[n]=i,v.countMap[n]=0),v.countMap[n]>=v.MAX_ERROR_COUNT||e.threading.GAThreading.performTaskOnGAThread((function(){v.addErrorEvent(e.EGAErrorSeverity.Warning,t,null,!0),v.countMap[n]=v.countMap[n]+1}))}},v.addSessionStartEvent=function(){if(s.isEventSubmissionEnabled()){var e={};e.category=v.CategorySessionStart,s.incrementSessionNum(),t.setItem(s.getGameKey(),s.SessionNumKey,s.getSessionNum().toString()),v.addDimensionsToEvent(e);var n=s.instance.currentGlobalCustomEventFields;v.addCustomFieldsToEvent(e,s.validateAndCleanCustomFields(n,v.customEventFieldsErrorCallback)),v.addEventToStore(e),a.i("Add SESSION START event"),v.processEvents(v.CategorySessionStart,!1)}},v.addSessionEndEvent=function(){if(s.isEventSubmissionEnabled()){var e=s.getSessionStart(),n=s.getClientTsAdjusted()-e;n<0&&(a.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),n=0);var t={};t.category=v.CategorySessionEnd,t.length=n,v.addDimensionsToEvent(t);var i=s.instance.currentGlobalCustomEventFields;v.addCustomFieldsToEvent(t,s.validateAndCleanCustomFields(i,v.customEventFieldsErrorCallback)),v.addEventToStore(t),a.i("Add SESSION END event."),v.processEvents("",!1)}},v.addBusinessEvent=function(e,n,i,r,o,d,c){if(void 0===o&&(o=null),s.isEventSubmissionEnabled()){var g=l.validateBusinessEvent(e,n,o,i,r);if(null==g){var f={};s.incrementTransactionNum(),t.setItem(s.getGameKey(),s.TransactionNumKey,s.getTransactionNum().toString()),f.event_id=i+":"+r,f.category=v.CategoryBusiness,f.currency=e,f.amount=n,f[s.TransactionNumKey]=s.getTransactionNum(),o&&(f.cart_type=o),v.addDimensionsToEvent(f);var m={};if(d&&0<Object.keys(d).length)for(var E in d)m[E]=d[E];else for(var E in s.instance.currentGlobalCustomEventFields)m[E]=s.instance.currentGlobalCustomEventFields[E];if(c&&d&&0<Object.keys(d).length)for(var E in s.instance.currentGlobalCustomEventFields)m[E]||(m[E]=s.instance.currentGlobalCustomEventFields[E]);v.addCustomFieldsToEvent(f,s.validateAndCleanCustomFields(m,v.customEventFieldsErrorCallback)),a.i("Add BUSINESS event: {currency:"+e+", amount:"+n+", itemType:"+i+", itemId:"+r+", cartType:"+o+"}"),v.addEventToStore(f)}else u.instance.sendSdkErrorEvent(g.category,g.area,g.action,g.parameter,g.reason,s.getGameKey(),s.getGameSecret())}},v.addResourceEvent=function(n,t,i,r,o,d,c){if(s.isEventSubmissionEnabled()){var g=l.validateResourceEvent(n,t,i,r,o,s.getAvailableResourceCurrencies(),s.getAvailableResourceItemTypes());if(null==g){n===e.EGAResourceFlowType.Sink&&(i*=-1);var f={},m=v.resourceFlowTypeToString(n);f.event_id=m+":"+t+":"+r+":"+o,f.category=v.CategoryResource,f.amount=i,v.addDimensionsToEvent(f);var E={};if(d&&0<Object.keys(d).length)for(var p in d)E[p]=d[p];else for(var p in s.instance.currentGlobalCustomEventFields)E[p]=s.instance.currentGlobalCustomEventFields[p];if(c&&d&&0<Object.keys(d).length)for(var p in s.instance.currentGlobalCustomEventFields)E[p]||(E[p]=s.instance.currentGlobalCustomEventFields[p]);v.addCustomFieldsToEvent(f,s.validateAndCleanCustomFields(E,v.customEventFieldsErrorCallback)),a.i("Add RESOURCE event: {currency:"+t+", amount:"+i+", itemType:"+r+", itemId:"+o+"}"),v.addEventToStore(f)}else u.instance.sendSdkErrorEvent(g.category,g.area,g.action,g.parameter,g.reason,s.getGameKey(),s.getGameSecret())}},v.addProgressionEvent=function(n,t,i,r,o,d,c,g){if(s.isEventSubmissionEnabled()){var f=v.progressionStatusToString(n),m=l.validateProgressionEvent(n,t,i,r);if(null==m){var E,p={};E=i?r?t+":"+i+":"+r:t+":"+i:t,p.category=v.CategoryProgression,p.event_id=f+":"+E;var h=0;d&&n!=e.EGAProgressionStatus.Start&&(p.score=Math.round(o)),n===e.EGAProgressionStatus.Fail&&s.incrementProgressionTries(E),n===e.EGAProgressionStatus.Complete&&(s.incrementProgressionTries(E),h=s.getProgressionTries(E),p.attempt_num=h,s.clearProgressionTries(E)),v.addDimensionsToEvent(p);var A={};if(c&&0<Object.keys(c).length)for(var S in c)A[S]=c[S];else for(var S in s.instance.currentGlobalCustomEventFields)A[S]=s.instance.currentGlobalCustomEventFields[S];if(g&&c&&0<Object.keys(c).length)for(var S in s.instance.currentGlobalCustomEventFields)A[S]||(A[S]=s.instance.currentGlobalCustomEventFields[S]);v.addCustomFieldsToEvent(p,s.validateAndCleanCustomFields(A,v.customEventFieldsErrorCallback)),a.i("Add PROGRESSION event: {status:"+f+", progression01:"+t+", progression02:"+i+", progression03:"+r+", score:"+o+", attempt:"+h+"}"),v.addEventToStore(p)}else u.instance.sendSdkErrorEvent(m.category,m.area,m.action,m.parameter,m.reason,s.getGameKey(),s.getGameSecret())}},v.addDesignEvent=function(e,n,t,i,r){if(s.isEventSubmissionEnabled()){var o=l.validateDesignEvent(e);if(null==o){var d={};d.category=v.CategoryDesign,d.event_id=e,t&&(d.value=n),v.addDimensionsToEvent(d);var c={};if(i&&0<Object.keys(i).length)for(var g in i)c[g]=i[g];else for(var g in s.instance.currentGlobalCustomEventFields)c[g]=s.instance.currentGlobalCustomEventFields[g];if(r&&i&&0<Object.keys(i).length)for(var g in s.instance.currentGlobalCustomEventFields)c[g]||(c[g]=s.instance.currentGlobalCustomEventFields[g]);v.addCustomFieldsToEvent(d,s.validateAndCleanCustomFields(c,v.customEventFieldsErrorCallback)),a.i("Add DESIGN event: {eventId:"+e+", value:"+n+"}"),v.addEventToStore(d)}else u.instance.sendSdkErrorEvent(o.category,o.area,o.action,o.parameter,o.reason,s.getGameKey(),s.getGameSecret())}},v.addErrorEvent=function(e,n,t,i,r){if(void 0===r&&(r=!1),s.isEventSubmissionEnabled()){var o=v.errorSeverityToString(e),d=l.validateErrorEvent(e,n);if(null==d){var c={};if(c.category=v.CategoryError,c.severity=o,c.message=n,v.addDimensionsToEvent(c),!r){var g={};if(t&&0<Object.keys(t).length)for(var f in t)g[f]=t[f];else for(var f in s.instance.currentGlobalCustomEventFields)g[f]=s.instance.currentGlobalCustomEventFields[f];if(i&&t&&0<Object.keys(t).length)for(var f in s.instance.currentGlobalCustomEventFields)g[f]||(g[f]=s.instance.currentGlobalCustomEventFields[f]);v.addCustomFieldsToEvent(c,s.validateAndCleanCustomFields(g,v.customEventFieldsErrorCallback))}a.i("Add ERROR event: {severity:"+o+", message:"+n+"}"),v.addEventToStore(c)}else u.instance.sendSdkErrorEvent(d.category,d.area,d.action,d.parameter,d.reason,s.getGameKey(),s.getGameSecret())}},v.addAdEvent=function(n,t,i,r,o,d,c,g,f){if(s.isEventSubmissionEnabled()){var m=v.adActionToString(n),E=v.adTypeToString(t),p=v.adErrorToString(o),h=l.validateAdEvent(n,t,i,r);if(null==h){var A={};A.category=v.CategoryAds,A.ad_sdk_name=i,A.ad_placement=r,A.ad_type=E,A.ad_action=m,n==e.EGAAdAction.FailedShow&&0<p.length&&(A.ad_fail_show_reason=p),!c||t!=e.EGAAdType.RewardedVideo&&t!=e.EGAAdType.Video||(A.ad_duration=d),v.addDimensionsToEvent(A);var S={};if(g&&0<Object.keys(g).length)for(var y in g)S[y]=g[y];else for(var y in s.instance.currentGlobalCustomEventFields)S[y]=s.instance.currentGlobalCustomEventFields[y];if(f&&g&&0<Object.keys(g).length)for(var y in s.instance.currentGlobalCustomEventFields)S[y]||(S[y]=s.instance.currentGlobalCustomEventFields[y]);v.addCustomFieldsToEvent(A,s.validateAndCleanCustomFields(S,v.customEventFieldsErrorCallback)),a.i("Add AD event: {ad_sdk_name:"+i+", ad_placement:"+r+", ad_type:"+E+", ad_action:"+m+(n==e.EGAAdAction.FailedShow&&0<p.length?", ad_fail_show_reason:"+p:"")+(!c||t!=e.EGAAdType.RewardedVideo&&t!=e.EGAAdType.Video?"":", ad_duration:"+d)+"}"),v.addEventToStore(A)}else u.instance.sendSdkErrorEvent(h.category,h.area,h.action,h.parameter,h.reason,s.getGameKey(),s.getGameSecret())}},v.processEvents=function(e,d){if(s.isEventSubmissionEnabled())try{var c=o.createGuid();d&&(v.cleanupEvents(),v.fixMissingSessionEndEvents());var g=[];g.push(["status",r.Equal,"new"]);var f=[];f.push(["status",r.Equal,"new"]),e&&(g.push(["category",r.Equal,e]),f.push(["category",r.Equal,e]));var m=[];m.push(["status",c]);var E=t.select(i.Events,g);if(!E||0==E.length)return a.i("Event queue: No events to send"),void v.updateSessionStore();if(E.length>v.MaxEventCount){if(!(E=t.select(i.Events,g,!0,v.MaxEventCount)))return;var p=E[E.length-1].client_ts;if(g.push(["client_ts",r.LessOrEqual,p]),!(E=t.select(i.Events,g)))return;f.push(["client_ts",r.LessOrEqual,p])}if(a.i("Event queue: Sending "+E.length+" events."),!t.update(i.Events,m,f))return;for(var h=[],A=0;A<E.length;++A){var S=E[A],y=JSON.parse(o.decode64(S.event));if(0!=y.length){var b=y.client_ts;b&&!l.validateClientTs(b)&&delete y.client_ts,h.push(y)}}u.instance.sendEventsInArray(h,c,v.processEventsCallback)}catch(e){a.e("Error during ProcessEvents(): "+e.stack),u.instance.sendSdkErrorEvent(n.EGASdkErrorCategory.Json,n.EGASdkErrorArea.ProcessEvents,n.EGASdkErrorAction.JsonError,n.EGASdkErrorParameter.Undefined,e.stack,s.getGameKey(),s.getGameSecret())}},v.processEventsCallback=function(e,n,s,o){var u=[];if(u.push(["status",r.Equal,s]),e===d.Ok)t.delete(i.Events,u),a.i("Event queue: "+o+" events sent.");else if(e===d.NoResponse){var l=[];l.push(["status","new"]),a.w("Event queue: Failed to send events to collector - Retrying next time"),t.update(i.Events,l,u)}else{if(n){var c,v=0;for(var g in n)0==v&&(c=n[g]),++v;e===d.BadRequest&&c.constructor===Array?a.w("Event queue: "+o+" events sent. "+v+" events failed GA server validation."):a.w("Event queue: Failed to send events.")}else a.w("Event queue: Failed to send events.");t.delete(i.Events,u)}},v.cleanupEvents=function(){t.update(i.Events,[["status","new"]])},v.fixMissingSessionEndEvents=function(){if(s.isEventSubmissionEnabled()){var e=[];e.push(["session_id",r.NotEqual,s.getSessionId()]);var n=t.select(i.Sessions,e);if(n&&0!=n.length){a.i(n.length+" session(s) located with missing session_end event.");for(var d=0;d<n.length;++d){var u=JSON.parse(o.decode64(n[d].event)),l=u.client_ts-n[d].timestamp;l=Math.max(0,l),u.category=v.CategorySessionEnd,u.length=l,v.addEventToStore(u)}}}},v.addEventToStore=function(e){if(s.isEventSubmissionEnabled())if(s.isInitialized())try{if(t.isStoreTooLargeForEvents()&&!o.stringMatch(e.category,/^(user|session_end|business)$/))return a.w("Database too large. Event has been blocked."),void u.instance.sendSdkErrorEvent(n.EGASdkErrorCategory.Database,n.EGASdkErrorArea.AddEventsToStore,n.EGASdkErrorAction.DatabaseTooLarge,n.EGASdkErrorParameter.Undefined,"",s.getGameKey(),s.getGameSecret());var d=s.getEventAnnotations();for(var l in e)d[l]=e[l];var c=JSON.stringify(d);a.ii("Event added to queue: "+c);var g={status:"new"};g.category=d.category,g.session_id=d.session_id,g.client_ts=d.client_ts,g.event=o.encode64(JSON.stringify(d)),t.insert(i.Events,g),e.category==v.CategorySessionEnd?t.delete(i.Sessions,[["session_id",r.Equal,d.session_id]]):v.updateSessionStore(),t.isStorageAvailable()&&t.save(s.getGameKey())}catch(l){a.e("addEventToStore: error"),a.e(l.stack),u.instance.sendSdkErrorEvent(n.EGASdkErrorCategory.Database,n.EGASdkErrorArea.AddEventsToStore,n.EGASdkErrorAction.DatabaseTooLarge,n.EGASdkErrorParameter.Undefined,l.stack,s.getGameKey(),s.getGameSecret())}else a.w("Could not add event: SDK is not initialized")},v.updateSessionStore=function(){if(s.sessionIsStarted()){var e={};e.session_id=s.instance.sessionId,e.timestamp=s.getSessionStart();var n=s.getEventAnnotations();v.addDimensionsToEvent(n);var r=s.instance.currentGlobalCustomEventFields;v.addCustomFieldsToEvent(n,s.validateAndCleanCustomFields(r,v.customEventFieldsErrorCallback)),e.event=o.encode64(JSON.stringify(n)),t.insert(i.Sessions,e,!0,"session_id"),t.isStorageAvailable()&&t.save(s.getGameKey())}},v.addDimensionsToEvent=function(e){e&&(s.getCurrentCustomDimension01()&&(e.custom_01=s.getCurrentCustomDimension01()),s.getCurrentCustomDimension02()&&(e.custom_02=s.getCurrentCustomDimension02()),s.getCurrentCustomDimension03()&&(e.custom_03=s.getCurrentCustomDimension03()))},v.addCustomFieldsToEvent=function(e,n){e&&n&&0<Object.keys(n).length&&(e.custom_fields=n)},v.resourceFlowTypeToString=function(n){return n==e.EGAResourceFlowType.Source||n==e.EGAResourceFlowType[e.EGAResourceFlowType.Source]?"Source":n==e.EGAResourceFlowType.Sink||n==e.EGAResourceFlowType[e.EGAResourceFlowType.Sink]?"Sink":""},v.progressionStatusToString=function(n){return n==e.EGAProgressionStatus.Start||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Start]?"Start":n==e.EGAProgressionStatus.Complete||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Complete]?"Complete":n==e.EGAProgressionStatus.Fail||n==e.EGAProgressionStatus[e.EGAProgressionStatus.Fail]?"Fail":""},v.errorSeverityToString=function(n){return n==e.EGAErrorSeverity.Debug||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Debug]?"debug":n==e.EGAErrorSeverity.Info||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Info]?"info":n==e.EGAErrorSeverity.Warning||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Warning]?"warning":n==e.EGAErrorSeverity.Error||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Error]?"error":n==e.EGAErrorSeverity.Critical||n==e.EGAErrorSeverity[e.EGAErrorSeverity.Critical]?"critical":""},v.adActionToString=function(n){return n==e.EGAAdAction.Clicked||n==e.EGAAdAction[e.EGAAdAction.Clicked]?"clicked":n==e.EGAAdAction.Show||n==e.EGAAdAction[e.EGAAdAction.Show]?"show":n==e.EGAAdAction.FailedShow||n==e.EGAAdAction[e.EGAAdAction.FailedShow]?"failed_show":n==e.EGAAdAction.RewardReceived||n==e.EGAAdAction[e.EGAAdAction.RewardReceived]?"reward_received":""},v.adErrorToString=function(n){return n==e.EGAAdError.Unknown||n==e.EGAAdError[e.EGAAdError.Unknown]?"unknown":n==e.EGAAdError.Offline||n==e.EGAAdError[e.EGAAdError.Offline]?"offline":n==e.EGAAdError.NoFill||n==e.EGAAdError[e.EGAAdError.NoFill]?"no_fill":n==e.EGAAdError.InternalError||n==e.EGAAdError[e.EGAAdError.InternalError]?"internal_error":n==e.EGAAdError.InvalidRequest||n==e.EGAAdError[e.EGAAdError.InvalidRequest]?"invalid_request":n==e.EGAAdError.UnableToPrecache||n==e.EGAAdError[e.EGAAdError.UnableToPrecache]?"unable_to_precache":""},v.adTypeToString=function(n){return n==e.EGAAdType.Video||n==e.EGAAdType[e.EGAAdType.Video]?"video":n==e.EGAAdType.RewardedVideo||n==e.EGAAdError[e.EGAAdType.RewardedVideo]?"rewarded_video":n==e.EGAAdType.Playable||n==e.EGAAdError[e.EGAAdType.Playable]?"playable":n==e.EGAAdType.Interstitial||n==e.EGAAdError[e.EGAAdType.Interstitial]?"interstitial":n==e.EGAAdType.OfferWall||n==e.EGAAdError[e.EGAAdType.OfferWall]?"offer_wall":n==e.EGAAdType.Banner||n==e.EGAAdError[e.EGAAdType.Banner]?"banner":""},v.CategorySessionStart="user",v.CategorySessionEnd="session_end",v.CategoryDesign="design",v.CategoryBusiness="business",v.CategoryProgression="progression",v.CategoryResource="resource",v.CategoryError="error",v.CategoryAds="ads",v.MaxEventCount=500,v.MAX_ERROR_COUNT=10,v.countMap={},v.timestampMap={},c=v,n.GAEvents=c}(r=r||{}),function(e){var n,t,i,r,s;function a(){this.blocks=new n.PriorityQueue({compare:function(e,n){return e-n}}),this.id2TimedBlockMap={},a.startThread()}n=e.threading||(e.threading={}),t=e.logging.GALogger,i=e.state.GAState,r=e.events.GAEvents,a.createTimedBlock=function(e){void 0===e&&(e=0);var t=new Date;return t.setSeconds(t.getSeconds()+e),new n.TimedBlock(t)},a.performTaskOnGAThread=function(e,t){void 0===t&&(t=0);var i=new Date;i.setSeconds(i.getSeconds()+t);var r=new n.TimedBlock(i);r.block=e,a.instance.id2TimedBlockMap[r.id]=r,a.instance.addTimedBlock(r)},a.performTimedBlockOnGAThread=function(e){a.instance.id2TimedBlockMap[e.id]=e,a.instance.addTimedBlock(e)},a.scheduleTimer=function(e,t){var i=new Date;i.setSeconds(i.getSeconds()+e);var r=new n.TimedBlock(i);return r.block=t,a.instance.id2TimedBlockMap[r.id]=r,a.instance.addTimedBlock(r),r.id},a.getTimedBlockById=function(e){return e in a.instance.id2TimedBlockMap?a.instance.id2TimedBlockMap[e]:null},a.ensureEventQueueIsRunning=function(){a.instance.keepRunning=!0,a.instance.isRunning||(a.instance.isRunning=!0,a.scheduleTimer(a.ProcessEventsIntervalInSeconds,a.processEventQueue))},a.endSessionAndStopQueue=function(){i.isInitialized()&&(t.i("Ending session."),a.stopEventQueue(),i.isEnabled()&&i.sessionIsStarted()&&(r.addSessionEndEvent(),i.instance.sessionStart=0))},a.stopEventQueue=function(){a.instance.keepRunning=!1},a.ignoreTimer=function(e){e in a.instance.id2TimedBlockMap&&(a.instance.id2TimedBlockMap[e].ignore=!0)},a.setEventProcessInterval=function(e){0<e&&(a.ProcessEventsIntervalInSeconds=e)},a.prototype.addTimedBlock=function(e){this.blocks.enqueue(e.deadline.getTime(),e)},a.run=function(){clearTimeout(a.runTimeoutId);try{for(var e;e=a.getNextBlock();)if(!e.ignore)if(e.async){if(!e.running){e.running=!0,e.block();break}}else e.block();return void(a.runTimeoutId=setTimeout(a.run,a.ThreadWaitTimeInMs))}catch(e){t.e("Error on GA thread"),t.e(e.stack)}},a.startThread=function(){a.runTimeoutId=setTimeout(a.run,0)},a.getNextBlock=function(){var e=new Date;return a.instance.blocks.hasItems()&&a.instance.blocks.peek().deadline.getTime()<=e.getTime()?a.instance.blocks.peek().async&&a.instance.blocks.peek().running?a.instance.blocks.peek():a.instance.blocks.dequeue():null},a.processEventQueue=function(){r.processEvents("",!0),a.instance.keepRunning?a.scheduleTimer(a.ProcessEventsIntervalInSeconds,a.processEventQueue):a.instance.isRunning=!1},a.instance=new a,a.ThreadWaitTimeInMs=1e3,a.ProcessEventsIntervalInSeconds=8,s=a,n.GAThreading=s}(r=r||{}),function(e){var n=e.threading.GAThreading,t=e.logging.GALogger,i=e.store.GAStore,r=e.state.GAState,s=e.http.GAHTTPApi,a=e.device.GADevice,o=e.validators.GAValidator,d=e.http.EGAHTTPApiResponse,u=e.utilities.GAUtilities,l=e.events.GAEvents,c=(v.getGlobalObject=function(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0},v.init=function(){if(a.touch(),v.methodMap.configureAvailableCustomDimensions01=v.configureAvailableCustomDimensions01,v.methodMap.configureAvailableCustomDimensions02=v.configureAvailableCustomDimensions02,v.methodMap.configureAvailableCustomDimensions03=v.configureAvailableCustomDimensions03,v.methodMap.configureAvailableResourceCurrencies=v.configureAvailableResourceCurrencies,v.methodMap.configureAvailableResourceItemTypes=v.configureAvailableResourceItemTypes,v.methodMap.configureBuild=v.configureBuild,v.methodMap.configureSdkGameEngineVersion=v.configureSdkGameEngineVersion,v.methodMap.configureGameEngineVersion=v.configureGameEngineVersion,v.methodMap.configureUserId=v.configureUserId,v.methodMap.initialize=v.initialize,v.methodMap.addBusinessEvent=v.addBusinessEvent,v.methodMap.addResourceEvent=v.addResourceEvent,v.methodMap.addProgressionEvent=v.addProgressionEvent,v.methodMap.addDesignEvent=v.addDesignEvent,v.methodMap.addErrorEvent=v.addErrorEvent,v.methodMap.addAdEvent=v.addAdEvent,v.methodMap.setEnabledInfoLog=v.setEnabledInfoLog,v.methodMap.setEnabledVerboseLog=v.setEnabledVerboseLog,v.methodMap.setEnabledManualSessionHandling=v.setEnabledManualSessionHandling,v.methodMap.setEnabledEventSubmission=v.setEnabledEventSubmission,v.methodMap.setCustomDimension01=v.setCustomDimension01,v.methodMap.setCustomDimension02=v.setCustomDimension02,v.methodMap.setCustomDimension03=v.setCustomDimension03,v.methodMap.setGlobalCustomEventFields=v.setGlobalCustomEventFields,v.methodMap.setEventProcessInterval=v.setEventProcessInterval,v.methodMap.startSession=v.startSession,v.methodMap.endSession=v.endSession,v.methodMap.onStop=v.onStop,v.methodMap.onResume=v.onResume,v.methodMap.addRemoteConfigsListener=v.addRemoteConfigsListener,v.methodMap.removeRemoteConfigsListener=v.removeRemoteConfigsListener,v.methodMap.getRemoteConfigsValueAsString=v.getRemoteConfigsValueAsString,v.methodMap.isRemoteConfigsReady=v.isRemoteConfigsReady,v.methodMap.getRemoteConfigsContentAsString=v.getRemoteConfigsContentAsString,v.methodMap.addOnBeforeUnloadListener=v.addOnBeforeUnloadListener,v.methodMap.removeOnBeforeUnloadListener=v.removeOnBeforeUnloadListener,void 0!==v.getGlobalObject()&&void 0!==v.getGlobalObject().GameAnalytics&&void 0!==v.getGlobalObject().GameAnalytics.q){var e=v.getGlobalObject().GameAnalytics.q;for(var t in e)v.gaCommand.apply(null,e[t])}window.addEventListener("beforeunload",(function(e){console.log("addEventListener unload"),r.instance.isUnloading=!0,r.notifyBeforeUnloadListeners(),n.endSessionAndStopQueue(),r.instance.isUnloading=!1}))},v.gaCommand=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];0<n.length&&n[0]in e.GameAnalytics.methodMap&&(1<n.length?e.GameAnalytics.methodMap[n[0]].apply(null,Array.prototype.slice.call(n,1)):e.GameAnalytics.methodMap[n[0]]())},v.configureAvailableCustomDimensions01=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)?t.w("Available custom dimensions must be set before SDK is initialized"):r.setAvailableCustomDimensions01(e)}))},v.configureAvailableCustomDimensions02=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)?t.w("Available custom dimensions must be set before SDK is initialized"):r.setAvailableCustomDimensions02(e)}))},v.configureAvailableCustomDimensions03=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)?t.w("Available custom dimensions must be set before SDK is initialized"):r.setAvailableCustomDimensions03(e)}))},v.configureAvailableResourceCurrencies=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)?t.w("Available resource currencies must be set before SDK is initialized"):r.setAvailableResourceCurrencies(e)}))},v.configureAvailableResourceItemTypes=function(e){void 0===e&&(e=[]),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)?t.w("Available resource item types must be set before SDK is initialized"):r.setAvailableResourceItemTypes(e)}))},v.configureBuild=function(e){void 0===e&&(e=""),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)?t.w("Build version must be set before SDK is initialized."):o.validateBuild(e)?r.setBuild(e):t.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: "+e)}))},v.configureSdkGameEngineVersion=function(e){void 0===e&&(e=""),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)||(o.validateSdkWrapperVersion(e)?a.sdkGameEngineVersion=e:t.i("Validation fail - configure sdk version: Sdk version not supported. String: "+e))}))},v.configureGameEngineVersion=function(e){void 0===e&&(e=""),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)||(o.validateEngineVersion(e)?a.gameEngineVersion=e:t.i("Validation fail - configure game engine version: Game engine version not supported. String: "+e))}))},v.configureUserId=function(e){void 0===e&&(e=""),n.performTaskOnGAThread((function(){v.isSdkReady(!0,!1)?t.w("A custom user id must be set before SDK is initialized."):o.validateUserId(e)?r.setUserId(e):t.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: "+e)}))},v.initialize=function(e,i){void 0===e&&(e=""),void 0===i&&(i=""),a.updateConnectionType();var s=n.createTimedBlock();s.async=!0,v.initTimedBlockId=s.id,s.block=function(){v.isSdkReady(!0,!1)?t.w("SDK already initialized. Can only be called once."):o.validateKeys(e,i)?(r.setKeys(e,i),v.internalInitialize()):t.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: "+e+", secretKey: "+i)},n.performTimedBlockOnGAThread(s)},v.addBusinessEvent=function(e,t,i,s,o,d,u){if(void 0===e&&(e=""),void 0===t&&(t=0),void 0===i&&(i=""),void 0===s&&(s=""),void 0===o&&(o=""),void 0===d&&(d={}),void 0===u&&(u=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add business event"))return;l.addBusinessEvent(e,t,i,s,o,d,u)}else n.performTaskOnGAThread((function(){v.isSdkReady(!0,!0,"Could not add business event")&&l.addBusinessEvent(e,t,i,s,o,d,u)}))},v.addResourceEvent=function(t,i,s,o,d,u,c){if(void 0===t&&(t=e.EGAResourceFlowType.Undefined),void 0===i&&(i=""),void 0===s&&(s=0),void 0===o&&(o=""),void 0===d&&(d=""),void 0===u&&(u={}),void 0===c&&(c=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add resource event"))return;l.addResourceEvent(t,i,s,o,d,u,c)}else n.performTaskOnGAThread((function(){v.isSdkReady(!0,!0,"Could not add resource event")&&l.addResourceEvent(t,i,s,o,d,u,c)}))},v.addProgressionEvent=function(t,i,s,o,d,u,c){if(void 0===t&&(t=e.EGAProgressionStatus.Undefined),void 0===i&&(i=""),void 0===s&&(s=""),void 0===o&&(o=""),void 0===u&&(u={}),void 0===c&&(c=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add progression event"))return;var g="number"==typeof d;l.addProgressionEvent(t,i,s,o,g?d:0,g,u,c)}else n.performTaskOnGAThread((function(){if(v.isSdkReady(!0,!0,"Could not add progression event")){var e="number"==typeof d;l.addProgressionEvent(t,i,s,o,e?d:0,e,u,c)}}))},v.addDesignEvent=function(e,t,i,s){if(void 0===i&&(i={}),void 0===s&&(s=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add design event"))return;var o="number"==typeof t;l.addDesignEvent(e,o?t:0,o,i,s)}else n.performTaskOnGAThread((function(){if(v.isSdkReady(!0,!0,"Could not add design event")){var n="number"==typeof t;l.addDesignEvent(e,n?t:0,n,i,s)}}))},v.addErrorEvent=function(t,i,s,o){if(void 0===t&&(t=e.EGAErrorSeverity.Undefined),void 0===i&&(i=""),void 0===s&&(s={}),void 0===o&&(o=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add error event"))return;l.addErrorEvent(t,i,s,o)}else n.performTaskOnGAThread((function(){v.isSdkReady(!0,!0,"Could not add error event")&&l.addErrorEvent(t,i,s,o)}))},v.addAdEventWithNoAdReason=function(t,i,s,o,d,u,c){if(void 0===t&&(t=e.EGAAdAction.Undefined),void 0===i&&(i=e.EGAAdType.Undefined),void 0===s&&(s=""),void 0===o&&(o=""),void 0===d&&(d=e.EGAAdError.Undefined),void 0===u&&(u={}),void 0===c&&(c=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add ad event"))return;l.addAdEvent(t,i,s,o,d,0,!1,u,c)}else n.performTaskOnGAThread((function(){v.isSdkReady(!0,!0,"Could not add ad event")&&l.addAdEvent(t,i,s,o,d,0,!1,u,c)}))},v.addAdEventWithDuration=function(t,i,s,o,d,u,c){if(void 0===t&&(t=e.EGAAdAction.Undefined),void 0===i&&(i=e.EGAAdType.Undefined),void 0===s&&(s=""),void 0===o&&(o=""),void 0===d&&(d=0),void 0===u&&(u={}),void 0===c&&(c=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add ad event"))return;l.addAdEvent(t,i,s,o,e.EGAAdError.Undefined,d,!0,u,c)}else n.performTaskOnGAThread((function(){v.isSdkReady(!0,!0,"Could not add ad event")&&l.addAdEvent(t,i,s,o,e.EGAAdError.Undefined,d,!0,u,c)}))},v.addAdEvent=function(t,i,s,o,d,u){if(void 0===t&&(t=e.EGAAdAction.Undefined),void 0===i&&(i=e.EGAAdType.Undefined),void 0===s&&(s=""),void 0===o&&(o=""),void 0===d&&(d={}),void 0===u&&(u=!1),a.updateConnectionType(),r.instance.isUnloading){if(!v.isSdkReady(!0,!0,"Could not add ad event"))return;l.addAdEvent(t,i,s,o,e.EGAAdError.Undefined,0,!1,d,u)}else n.performTaskOnGAThread((function(){v.isSdkReady(!0,!0,"Could not add ad event")&&l.addAdEvent(t,i,s,o,e.EGAAdError.Undefined,0,!1,d,u)}))},v.setEnabledInfoLog=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread((function(){e?(t.setInfoLog(e),t.i("Info logging enabled")):(t.i("Info logging disabled"),t.setInfoLog(e))}))},v.setEnabledVerboseLog=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread((function(){e?(t.setVerboseLog(e),t.i("Verbose logging enabled")):(t.i("Verbose logging disabled"),t.setVerboseLog(e))}))},v.setEnabledManualSessionHandling=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread((function(){r.setManualSessionHandling(e)}))},v.setEnabledEventSubmission=function(e){void 0===e&&(e=!1),n.performTaskOnGAThread((function(){e?(r.setEnabledEventSubmission(e),t.i("Event submission enabled")):(t.i("Event submission disabled"),r.setEnabledEventSubmission(e))}))},v.setCustomDimension01=function(e){void 0===e&&(e=""),n.performTaskOnGAThread((function(){o.validateDimension01(e,r.getAvailableCustomDimensions01())?r.setCustomDimension01(e):t.w("Could not set custom01 dimension value to '"+e+"'. Value not found in available custom01 dimension values")}))},v.setCustomDimension02=function(e){void 0===e&&(e=""),n.performTaskOnGAThread((function(){o.validateDimension02(e,r.getAvailableCustomDimensions02())?r.setCustomDimension02(e):t.w("Could not set custom02 dimension value to '"+e+"'. Value not found in available custom02 dimension values")}))},v.setCustomDimension03=function(e){void 0===e&&(e=""),n.performTaskOnGAThread((function(){o.validateDimension03(e,r.getAvailableCustomDimensions03())?r.setCustomDimension03(e):t.w("Could not set custom03 dimension value to '"+e+"'. Value not found in available custom03 dimension values")}))},v.setGlobalCustomEventFields=function(e){void 0===e&&(e={}),n.performTaskOnGAThread((function(){t.i("Set global custom event fields: "+JSON.stringify(e)),r.instance.currentGlobalCustomEventFields=e}))},v.setEventProcessInterval=function(e){n.performTaskOnGAThread((function(){n.setEventProcessInterval(e)}))},v.startSession=function(){if(r.isInitialized()){var e=n.createTimedBlock();e.async=!0,v.initTimedBlockId=e.id,e.block=function(){r.isEnabled()&&r.sessionIsStarted()&&n.endSessionAndStopQueue(),v.resumeSessionAndStartQueue()},n.performTimedBlockOnGAThread(e)}},v.endSession=function(){v.onStop()},v.onStop=function(){n.performTaskOnGAThread((function(){try{n.endSessionAndStopQueue()}catch(e){}}))},v.onResume=function(){var e=n.createTimedBlock();e.async=!0,v.initTimedBlockId=e.id,e.block=function(){v.resumeSessionAndStartQueue()},n.performTimedBlockOnGAThread(e)},v.getRemoteConfigsValueAsString=function(e,n){return void 0===n&&(n=null),r.getConfigurationStringValue(e,n)},v.isRemoteConfigsReady=function(){return r.isRemoteConfigsReady()},v.addRemoteConfigsListener=function(e){r.addRemoteConfigsListener(e)},v.removeRemoteConfigsListener=function(e){r.removeRemoteConfigsListener(e)},v.getRemoteConfigsContentAsString=function(){return r.getRemoteConfigsContentAsString()},v.getABTestingId=function(){return r.getABTestingId()},v.getABTestingVariantId=function(){return r.getABTestingVariantId()},v.addOnBeforeUnloadListener=function(e){r.addOnBeforeUnloadListener(e)},v.removeOnBeforeUnloadListener=function(e){r.removeOnBeforeUnloadListener(e)},v.internalInitialize=function(){r.ensurePersistedStates(),i.setItem(r.getGameKey(),r.DefaultUserIdKey,r.getDefaultId()),r.setInitialized(!0),v.newSession(),r.isEnabled()&&n.ensureEventQueueIsRunning()},v.newSession=function(){t.i("Starting a new session."),r.validateAndFixCurrentDimensions(),s.instance.requestInit(r.instance.configsHash,v.startNewSessionCallback)},v.startNewSessionCallback=function(e,s){if(e!==d.Ok&&e!==d.Created||!s)e==d.Unauthorized?(t.w("Initialize SDK failed - Unauthorized"),r.instance.initAuthorized=!1):(e===d.NoResponse||e===d.RequestTimeout?t.i("Init call (session start) failed - no response. Could be offline or timeout."):e===d.BadResponse||e===d.JsonEncodeFailed||e===d.JsonDecodeFailed?t.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers."):e!==d.BadRequest&&e!==d.UnknownResponseCode||t.i("Init call (session start) failed - bad request or unknown response."),null==r.instance.sdkConfig?null!=r.instance.sdkConfigCached?(t.i("Init call (session start) failed - using cached init values."),r.instance.sdkConfig=r.instance.sdkConfigCached):(t.i("Init call (session start) failed - using default init values."),r.instance.sdkConfig=r.instance.sdkConfigDefault):t.i("Init call (session start) failed - using cached init values."),r.instance.initAuthorized=!0);else{var a=0;if(s.server_ts){var o=s.server_ts;a=r.calculateServerTimeOffset(o)}if(s.time_offset=a,e!=d.Created){var c=r.getSdkConfig();c.configs&&(s.configs=c.configs),c.configs_hash&&(s.configs_hash=c.configs_hash),c.ab_id&&(s.ab_id=c.ab_id),c.ab_variant_id&&(s.ab_variant_id=c.ab_variant_id)}r.instance.configsHash=s.configs_hash?s.configs_hash:"",r.instance.abId=s.ab_id?s.ab_id:"",r.instance.abVariantId=s.ab_variant_id?s.ab_variant_id:"",i.setItem(r.getGameKey(),r.SdkConfigCachedKey,u.encode64(JSON.stringify(s))),r.instance.sdkConfigCached=s,r.instance.sdkConfig=s,r.instance.initAuthorized=!0}if(r.instance.clientServerTimeOffset=r.getSdkConfig().time_offset?r.getSdkConfig().time_offset:0,r.populateConfigurations(r.getSdkConfig()),!r.isEnabled())return t.w("Could not start session: SDK is disabled."),void n.stopEventQueue();n.ensureEventQueueIsRunning();var g=u.createGuid();r.instance.sessionId=g,r.instance.sessionStart=r.getClientTsAdjusted(),l.addSessionStartEvent();var f=n.getTimedBlockById(v.initTimedBlockId);null!=f&&(f.running=!1),v.initTimedBlockId=-1},v.resumeSessionAndStartQueue=function(){r.isInitialized()&&(t.i("Resuming session."),r.sessionIsStarted()||v.newSession())},v.isSdkReady=function(e,n,i){return void 0===n&&(n=!0),void 0===i&&(i=""),i&&(i+=": "),e&&!r.isInitialized()?(n&&t.w(i+"SDK is not initialized"),!1):e&&!r.isEnabled()?(n&&t.w(i+"SDK is disabled"),!1):!(e&&!r.sessionIsStarted()&&(n&&t.w(i+"Session has not started yet"),1))},v.initTimedBlockId=-1,v.methodMap={},v);function v(){}e.GameAnalytics=c}(r=r||{}),r.GameAnalytics.init();var d=r.GameAnalytics.gaCommand;e.gameanalytics=r,e.GameAnalytics=d}(this);